/*! progressbar 2014-10-20 */
var ProgressBarModel=Backbone.Model.extend({defaults:function(){return{id:"",progress:0}}}),ProgressBarList=Backbone.Collection.extend({model:ProgressBarModel,url:"data.json"}),ProgressBarView=Backbone.View.extend({tagName:"div",render:function(){"use strict";this.$el.attr({id:this.model.get("id")}).addClass("progressBars");var a=this.model.get("progress"),b=a>100?" red":"";this.$el.html('<div class="barTitle">'+a+"%</div>");var c=Math.min(a-100,0),d='<div class="barBackground'+b+'" style="left:'+c+'%">&nbsp;</div>';return this.$el.append(d),this}}),ProgressBarSelectView=Backbone.View.extend({tagName:"option",render:function(){var a=this.model.get("id");return this.$el.val(a).html("#"+a),this}}),MainView=Backbone.View.extend({el:"body",collection:new ProgressBarList,initialize:function(){return this.collection.fetch({success:function(){app.render()}}),this},render:function(){return $("#progressBarsHolder").html(""),$("#selectBar").html(""),this.collection.each(function(a){var b=new ProgressBarView({model:a});$("#progressBarsHolder").append(b.render().el);var c=new ProgressBarSelectView({model:a});$("#selectBar").append(c.render().el)}),this},showProgress:function(a,b){this.collection.some(function(c){if(c.get("id")===a){var d=c.get("progress"),e=d+b;e=Math.max(e,0),c.set({progress:e});var f=Math.min(e-100,0);return $("#"+a+" > .barBackground").animate({left:f+"%"},10*Math.abs(b),"linear"),e>100?$("#"+a+" > .barBackground").addClass("red"):$("#"+a+" > .barBackground").removeClass("red"),$("#"+a+" > .barTitle").html(e+"%"),!0}})}}),app=new MainView,ControlView=Backbone.View.extend({el:$("button"),events:{click:"btnClickFunc"},btnClickFunc:function(a){"use strict";var b=$("#selectBar").val(),c=parseInt($(a.currentTarget).html(),10);app.showProgress(b,c)}}),ctrlView=new ControlView;$(window).smartresize(app.render());